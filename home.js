// Another page where ASCII/projects already rendered

const asciiArt = `
                                                       -      โ                                                                                       
                                                 โ-++-++ +++-+++++++ -+=โรท-+  รทร ++++++รท                                                              
                                            โ+ร+++ร-รท  รท++++รทโฯ+++ฯโ=โฯโ-รโ-++++รทโโ   โโรฯ                                                            
                                        =+ร++++-++  โโ-  โ+++-ร  รโ+++-ร=โรท+โ  โ+รโ-+++=++รท-+++รโ                                                     
                                   ร+++++โ โ   ร=-โร โ++โโ+-โโโ โ     +-โโโ+++โ +ร=-โโร+โ++  โ=++++++โ                                                
                                โ++- ฯ++ ฯ-+โ-โฯ+ โโโโ โ++ฯฯโร=++โ- -= โ+=โฯ ++รท=ฯ =+=++ฯ++ โ-โโโโ โ++++                                              
                   โ           +-ฯ+รโ== รทฯ+ฯร+ โโ รท=รโ+ โโ-โรท+ร=+ + โ-ฯ โโ++โ  โร++ ฯ+โโรโ รท++โโโ-+โ  ร++                                             
                   ร++++-+++++++ร ++โ+- โ+โโ+โ รโ=โ +-+ฯ+++-โโ=++โ-โ++รโรท+ฯ++โโโฯ+++ ฯ+= ++รทรท++++รทร=โ+โ +โ                                            
                        ++++-โ+   ฯรทโ-โโโ=รทโโ-++ โโโ+โ+โโ--+โ+= +รท=โ=โรทโ--โ+++=รท ++++โโ++=+รท-+++=++-+++= โ                                            
                        โโโ โ+โฯ  =+รทโโ+  +=++โรรโโ+=++โโ+-+-+รโโ+โรโ++ฯรท+รร-+-ฯรโ+++โรท+รร+=ฯ+++โ+รโโ+ร+โโ                                            
                   -+++++ -+ รโโโ+ โรโ+++= =+รท-รรท=โรโ+โ+โรท---โ-=++ โ-โ- โ=รทรโโ+โรท โ-- =+รท++-โโ+โโ++ร++ -+โ++-                                         
                 โ+++โ- รท ++  โ +ร+รทรทโ++++รทโโรท+รฯฯโโโร+โรทฯรท-+โร==+  =+โโโโ=รทรท ++โโโ-+โ=รรท=++โร+ร++รโโโรท+--โโ                                          
                ++++ + ++--+โ++ ++=โร+โร++-รโ=โ- โ++โโ+ +ร+=รท รท ++  โ+---โรท-รทโโ-  โฯ-+++ร -+โรร+++รร+++-รท++โ++ร                                       
               โ++   ร++++โโโ++++++- โ=+โร++  รท++โ + ++โ รท=-+ร-=โ+  +-ฯ==ฯโ=โโโ-โ ฯรฯ++ร=+รท-รทโ+-++โ ร=ร++โโ+ร++ร                                      
              +++โ  ร=+-++โโ-+โ+++-+ฯ โโฯ++++- โ โโฯ +โร โ-+โร โ +  ฯรทโ==   โโ โ=  ร=+++โ=โ++++รทรท-=-+ร +++=โโรท-+                                      
            โ+-โ-  รทโ+ร+++โโรท+โ+++-++รทฯ+++ฯ++รท รทร+-โ โ++ โ=ฯรทโ ++ + + รทรทโโ   โโโรทโ รท+โ++โร +ร+++โ++โ++โ+=-+โโร+++                                     
         =ฯโฯโ=ร+ รท โ=โ+++รทโโ+ ++++-++โร+ฯ=++++ โโร=โร +รโรท โร โ+โร โรทฯโโ ฯ    โโรท  +-+รทโโโ+++++โโโ-+รท =-+-โ=รทโโ                                      
          ++++รท+= =โร+ร+--รโ-+ ร+++โ+++ =โ-ฯร++ร ฯโ โ   =รท= ฯ++  รท  +   ร โ   ฯโโโโฯ=-++โฯ -++++-=โโ+=โ+++=ฯ++รท=โ                                     
         โ  ++โ+โ โโโโร++=ฯ โ+รทรท++โ-+ร+-ฯ+++ ฯ-+รทโ ฯโโ- โ ++  ร-  รรฯ+    โโ  โฯโโ  โ++โ  รทรท++++==-++ฯโรทรทรโ=++-รท =                                    
        ร ฯ++- โโโ ร=โร++-รทโโโ+โ ++รท+++-+=++=โ โ+-=  โฯ+โ  ++โโ++โโ+ +รโโรทโโโ   ฯโโโโ++โฯ +++++--=-++โโ+=โร++++-                                      
       รรรร+++ฯโรทโ+ร โ++=++โ โ++ รทโโโ-++=+ฯ+++=รรทโรท+โร โ-+โโ-+==-++รท=โ=โ-+รทโฯรทโ   โ ฯ== โ=โ++++-+++ร++รโโโ++++รร++                                    
       +โ โ++=โ โ โ+ =++=-++   -=ฯ++โโรโรรทโโ++รโ-++++รท-+=++-โรท-ร+-รร++++++++โ -รท  ฯ โโฯ โ= +++++++รท++โโรท+++++-=+--                                    
       รทร โรทรท== โรทรทฯ  ++=ฯโ+--  โ-โ+โรรโ โ+ โ++รรท=รทโรทรรทร-++++-โโ-+++รรทรทรทรร+++++โ=โ  โโฯ ฯโ +++++-++-+รท++++++++++ +                                    
      รโรท  ฯโรทรโ   โ โโโ+โโร+-++โรทรท=โ =ร  ฯ+โ +++-=ฯ    โโ---+-รทโ            โ++++โ=โโโโโรฯ+++++++++++++=+++++++โรร                                   
       -= โ ฯโ=-โรทรทโรทฯ รท  โโโ-โรรรโ    โโโ  ร =+รทโฯ          โโ                          ฯร+โ+++++++-++โ++++++-+โ+-                                   
       ร   ฯฯ โโฯ=รท+++โโรท-โโโ+ โฯโ  โ    ฯโ+โร โโฯ                                         รทโ+++รทร+++++=++++++++รท+โโ                                  
       +  +++ฯ   โ   =+รท ฯโฯโฯ - =โ        +ฯ-= ฯ                                           =+-ร+++++-++++++++==รทรทฯโ                                  
       +-ฯร++รท-โ       โ    โร=โฯโ         ร=ฯ+ฯฯ                                         โ  =โ=++++++-++-++++++++โ                                   
       +  ฯฯ  ฯโโ            โร+โ             โโ                                          ฯโโ++++++++++++++--+ร++โ                                    
       +  รร     ฯรท     โโ     ฯ-+โ                                                        โ-++++++++++++==-+รโ    ฯ                                  
        ฯ  โรท                                                                             โ++++++++++-++=ร+ร+โ   ร-รโ                                 
       โรท   โ                                                                            -++++++++++++++รรท++-    ร=โ                                  
        +  โโ                                                        ฯ                   ฯ-+ร+++++++++ร+โ=++      รรท  =                               
        -โ โ++                                                 โร-รรท                       ร++++-++++รทรทโโร++โ     =-  +                               
        โ+  ++                                            โรรร+-โ                             -++++++รทโร++รท        ร                                  
   =     +ฯโ+++                                        =ร---รทโ                             +รท รท=++++รฯ-=-  รท         โ                                
      โ  -  +++                                       ฯ       โโ  โโรท==โโโโ=โ              โ+++++++โฯ =+ร โ+รโ ฯโโ   +                                
         โฯฯ+++                                          โ++-ฯ-+++ ++++++++รท                 รทร-รท     รร+ ++โ   ฯโ                                    
          ร-ร++                                       ฯ=++  ฯ+   ++++โรท+                              ฯ+   รทรทฯ   โ                                    
           รทโ=โ  ฯ=++++ร-++รโ                       โ --   โ      รท++++                               -         โโ  โ                                 
            -โ                                           +รโโ                                        +        โร   โ                                  
              -โ           +++++++=รท=รโ                                                             โโ       โ    โ                                   
                รท      -++++รโ++รท+=                    =โฯ                                                โ+         โ                                
                รฯ  โ+++   -++++++  โ                                                                                                                 
             +++++   =                                                                                   ฯ                                            
                  +                                                                                              โ                                    
                  ร                                                                                           โ                                       
                                                                                                           +โ                                         
                                                                                                           โ                                          
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                           ร                                                                                          
                                                 โร-รทรร++-โ                                                                                           
                                             ฯ  =รทรโโฯฯ                                                                                               
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                             ฯโ-+++ร                                                                                  
                                                     รท++++--+-+=                                                                                      
                                        โโร-------++--ฯ                                                                                               
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
            ฯ                                        ฯโโ                                    ฯ                                                          
             ฯ                                                                            โ                                                            
              ฯ                                                                         ฯ                                                              
               ฯ                                                                       รทฯ                                                              
               ฯ                          โ                                         โ                                                                 
                 โโ                                                               =โ                                      โ+++                        
                  -                         +                                  โโโ                                           +++โ                     
                 โโ                       ++++                             ฯโโโ  ฯฯ                                         +++++++                   
                =-                      ++++++++                        โโโฯ                                               รท++++++++++ฯ               
                         โ-+                      ฯ++++++++++โ รทรท               รทโโ                                                    ++++++++++++++++           
           ร+โ                       +++++++ร+++++      โโโโโโโ=โ                                                         +++++++++++++++++++         
        โ-+                         +++++++++++รทโ++                                                                      ++++++++++++++++++++++       
      =+                          โ+++++++++++โโ+++                                                                     ร++++++++++++++++++++++++     
    ฯ+                           ++++++++++++โร+++++                                                                    ++++++++++++++++++++++++++++  
  โร                            +++++++++++โ=+++++ร                                                                    +++++++++++++++++++++++++++++++
                               +++++++++++รรท++++                                                                      ++++++++++++++++++++++++++++++++
  =                             +++++++++++-ร+++                                                                       ++++++++++++++++++++++++++++++++-
                            รท++++++++++++ร+++                                                                       ++++++++++++++++++++++++++++++++++
                               โ+++++++++++โ+++ร                                                                       +++++++++++++++++++++++++++++++++++
                               +++++++++ร-รท-+++                                                                       ++++++++++++++++++++++++++++++++++++
                                +++++++++++รท-+++                                                                       +++++++++++++++++++++++++++++++++++++
                               +++++++++++-++++                                                                       ++++++++++++++++++++++++++++++++++++ร 
                               +++++++++++-++++                                                                      +++++++++++++++++++++++++++++++++++รโ  
                        +++++++++++-++++                                                                      +++++++++++++++++++++++++++++++++++=ฯ   
                         โ+++++++++++++                                                                      ร+++++++++++++++++++++++++++++++++รทฯ     
       โ                                                              +++++++++                                                                      +++++++++++++++++++++++++++++++++รทโ                                 
 `;

// Text to be rendered for nav menu options

const contentMap = {
    Projects: `Brave, 2024
Embedded AI-driven sound synthesiser, enabling network-bending
---------------------------------------------------------------
Ancestral (r)Evocations, 2024
Archival sonification instrument, live ML feedback soundscape
---------------------------------------------------------------
Iconostasis, 2023
Audio-reactive roses, using JavaScript + PureData 
---------------------------------------------------------------`,
    CV: `This is the CV content.\nMore lines here...`,
    Bio: `.๐ฅ  ห London, UK

Developer specialising in ML-based audio synthesis, instrument fabrication and human-AI interaction.
Seeking to empower artists in a rapidly developing gen-AI landscape, designing systems that can meaningfully support expression & agency.

GitHub <<<<<<<<<<
LinkedIn <<<<<<<<`,
    Contact: `please feel free to contact me โนโฐ(โฃสโฃ)โฏโน
email: danmanzdesign@gmail.com
number: +44 7581 466 806
instagram: @manzzzzzzzzzzd
`
};

// Links to projects
const projectsLinks = {
  'Brave, 2024\nEmbedded AI-driven sound synthesiser, enabling network-bending': 'brave.html',
  'Ancestral (r)Evocations, 2024\nArchival sonification instrument, live ML feedback soundscape': 'ancestral.html',
  'Iconostasis, 2023\nAudio-reactive roses, using JavaScript + PureData': 'iconostasis.html'
};

const bioLinks = {
  'GitHub': 'https://github.com/danielmanz17',
  'LinkedIn': 'https://www.linkedin.com/in/daniel-manz-a0464b1b2/'
};


document.addEventListener("DOMContentLoaded", () => {
  const asciiTarget = document.getElementById("ascii-art");

  let asciiIndex = 0;
  let asciiDisplay = asciiArt.split('').map(ch => (ch === '\n' ? '\n' : ' '));

  const nonSpaceIndices = [];
  for (let i = 0; i < asciiArt.length; i++) {
    if (asciiArt[i] !== ' ' && asciiArt[i] !== '\n') {
      nonSpaceIndices.push(i);
    }
  }
  
  // Render ASCII art instantly
  asciiTarget.textContent = asciiArt;

  const textBox = document.getElementById("text-box-nav");

  function renderTextBox(text, linksMap = null, instant = false) {
    function escapeRegExp(string) {
      return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&');
    }

    if (instant) {
      // Instant render with line breaks and links
      let html = text.replace(/\n/g, '<br>');
      if (linksMap) {
        Object.entries(linksMap).forEach(([txt, href]) => {
          // Convert the link text from contentMap format to HTML format for matching
          const htmlText = txt.replace(/\n/g, '<br>');
          const regex = new RegExp(escapeRegExp(htmlText), 'g');
          const isExternal = href.startsWith('http');
          const anchor = `<a href="${href}"${isExternal ? ' target="_blank"' : ''}>${htmlText}</a>`;
          html = html.replace(regex, anchor);
        });
      }
      textBox.innerHTML = html;
      return;
    }

    // Incremental typing effect
    let i = 0;
    const chars = text.split('');
    const display = [];

    function renderStep() {
      if (i < chars.length) {
        display.push(chars[i]);
        textBox.innerHTML = display.join('').replace(/\n/g, '<br>');
        i++;
        setTimeout(renderStep, 0);
      } else if (linksMap) {
        Object.entries(linksMap).forEach(([txt, href]) => {
          // Convert the link text from contentMap format to HTML format for matching
          const htmlText = txt.replace(/\n/g, '<br>');
          const regex = new RegExp(escapeRegExp(htmlText), 'g');
          const isExternal = href.startsWith('http');
          const anchor = `<a href="${href}"${isExternal ? ' target="_blank"' : ''}>${htmlText}</a>`;
          textBox.innerHTML = textBox.innerHTML.replace(regex, anchor);
        });
      }
    }

    renderStep();
  }

  // Initially render Projects section instantly
  renderTextBox(contentMap['Projects'], projectsLinks, true);

  // Making nav links clickable
  document.querySelectorAll('nav .menu li a').forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      const key = e.target.textContent.trim();
      
      console.log('Clicked nav item:', key); // Debug log
      console.log('Available keys:', Object.keys(contentMap)); // Debug log
      
      if (key === 'CV') {
        window.open('./assets/docs/cv.pdf', '_blank');
      } else if (key === 'Projects' || key === 'Portfolio') {
        // Handle both "Projects" and "Portfolio" text - render with typing animation when clicked
        renderTextBox(contentMap['Projects'], projectsLinks, false);
      } else if (key === 'Bio') {
        renderTextBox(contentMap['Bio'], bioLinks, false);
      } else if (key === 'Contact') {
        renderTextBox(contentMap['Contact'], null, false);
      } else {
        console.log('No matching content for key:', key); // Debug log
      }
    });
  });
});